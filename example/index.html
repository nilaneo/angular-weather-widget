<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Weather widget</title>

        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.min.css">
        <link rel="stylesheet" href="../dist/css/weather-widget.min.css">

        <!--[if IE]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>
    <body>
        <div ng-app="exampleApp">
            <nn-weather-widget city="Kyiv"></nn-weather-widget>
        </div>


        <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.1/angular.min.js"></script>
        <!-- <script src="../dist/js/weather-widget.min.js"></script> -->

        <script type="text/javascript">
            angular
                .module('nnWeather', [])

                .factory('nnWeatherService', function($http) {
                    return {
                        getForecast: function(city) {
                            return $http
                                .get('http://api.openweathermap.org/data/2.5/forecast/daily', {
                                    params: {
                                        q: city,
                                        units: "metric",
                                        cnt: 7
                                    }
                                })
                                .then(function(resp) {
                                    return resp.data;
                                });
                        }
                    };
                })

                .directive('nnWeatherWidget', function() {
                    return {
                        scope: {
                            city: '@'
                        },
                        templateUrl: '../dist/templates/super-widget.tpl.min.html',
                        controller: function($scope, nnWeatherService) {
                            $scope.forecast = null;

                            nnWeatherService
                                .getForecast($scope.city)
                                .then(function(forecast) {
                                    $scope.forecast = forecast;
                                });
                        }
                    };
                });

            angular.module('exampleApp', ['nnWeather']);
        </script>
    </body>
</html>
